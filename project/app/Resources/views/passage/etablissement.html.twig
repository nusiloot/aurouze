{% set _menu_active = 'passage' %}
{% extends 'base.html.twig' %}
{% block body %}
    <div class="row">
        <div class="col-xs-12">
            <div class="panel panel-default">
                <div class="panel-heading">
                    <div class="row">
                        <div class="col-xs-6">
                            <strong>{{ etablissement.nom }}</strong>
                        </div>
                        <div class="col-xs-6">
                            Société {{ etablissement.raisonsociale }}
                        </div>
                    </div>
                </div>
                <div class="panel-body">
                    <div class="row">
                        <div class="col-xs-10">
                            {{ etablissement.adressecomplete }}
                        </div>
                        <div class="col-xs-2">
                            <i style="cursor: default;" class="pull-right mdi mdi-{{ etablissement.iconTypeEtb }} mdi-4x" title="{{ etablissement.typeEtablissement }}" data-toggle="tooltip" ></i>

                        </div>
                    </div>
                    <div class="row">
                        <div class="col-xs-6">
                            Tél fixe : {{ etablissement.adresse.telephonefixe }}
                        </div>
                        <div class="col-xs-6">
                            Tél portable : {{ etablissement.adresse.telephoneportable }}
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="row">
        <div class="col-xs-12">
            <div class="panel-group" id="accordion" role="tablist" aria-multiselectable="true">
                {% for pe in passages %}
                <div class="panel panel-default">
        		    <div class="panel-heading" role="tab" id="heading-{{ pe.identifiant }}">
        		        <h4 class="panel-title">
                            <div class="row">
                                <div class="col-xs-8">
                                    <div class="row">
        	                            <div class="col-xs-6">
        	                                <span><i class="mdi mdi-today mdi-lg"></i>&nbsp;{{ pe.dateDebut | localizeddate('full', 'none') }} {{ pe.dateDebut | localizeddate('none', 'short') }}</span> 
        	                            </div>
        	                            <div class="col-xs-2">
        	                                {% if(pe.duree) %}<span><i class="mdi mdi-schedule mdi-lg"></i>&nbsp;{{ pe.duree }}</span>{% endif %}
        	                            </div>
                                        <div class="col-xs-4">
                                            <i class="mdi mdi-face mdi-lg"></i>&nbsp;{{ pe.technicien }}
                                        </div>
                                    </div>
                                </div>
                                <div class="col-xs-4">
                                    <span class="pull-right">
                                        {% if(pe.realise) %} <span class="label label-success">Réalisé</span>
                                        {% elseif(pe.planifie)  %} <span class="label label-default">Planifié non réalisé</span>
                                        {% elseif(pe.nonplanifie)  %} <a class="btn btn-sm btn-warning" href="{{path('calendar', {'etablissement' : pe.etablissementIdentifiant, 'passage' : pe.identifiant,'technicien' : pe.technicien})}}">Planifier le passage</a>
                                        {% endif %}  
                                    </span>
                                </div>
                            </div> 
                            <h5><a role="button" data-toggle="collapse" data-parent="#accordion" href="#collapse-{{ pe.identifiant }}" aria-expanded="false" aria-controls="collapseOne">{{ pe.libelle }}</a>
            	        	</h5>
        		        </h4>
        		    </div>
        		    <div id="collapse-{{ pe.identifiant }}" class="panel-collapse collapse" role="tabpanel" aria-labelledby="heading-{{ pe.identifiant }}">
            		    <div class="panel-body">
            		        {{ pe.descriptionTransformed | nl2br }}
            		    </div>
        		    </div>
        		</div>
                {% endfor %}
            </div>
        </div>
    </div>
{% endblock %}
